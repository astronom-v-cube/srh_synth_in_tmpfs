# Скрипт для многопточного синтеза изображений с Сибирского радиогелиографа в оперативной памяти

### Что нужно знать о скрипте:
1. Работает с библиотекой ```srhdata```
2. ```srh48_api``` не поддерживается
3. Расчитан на использование с калибровочной таблицей, но поменяв параметры, можно включить синтез и без нее
4. Синтез - многопоточный. Можно менять количество потоков, то есть количество синтезируемых одновременно файлов. От количества потоков зависит потребление ресурсов процессора и оперативной памяти
5. При количестве потоков 8+ рекомендуется наличие 16+ Гб оперативной памяти
6. Для запуска скрипта у вас должна быть настроенное виртуальное окружение ```Python 3.8``` или ```Python 3.10```, установленная библиотека ```srhdata``` со всеми зависимостями
7. Скрипт умеет восстанавливать прогресс при неожиданном завешении работы. В процессе синтеза в рабочей директории будут появляться два файла: один со списком всех задач, второй со списком выполненных задач. В случае внезапной приостановки при повторном запуске кода списки задач будут считаны и работа продолжится с места остановки. При окончании работ файлы задач уничтожаются
8. При синтезе происходит чистка с параметрами ```deconvolver = 'multiscale', scales=[0, 3]```, можете редактировать это в соответствии с документацией CASA

### Как использовать скрипт:
1. Заполнить ```config.py```
   - observation_range - диапазон, в котором ведется обработка: '0306', '0612' или '1224'
   - path_to_calib_tables - путь до калибровочной таблицы
   - directory_of_data - путь до файлов сырых данных
   - directory_of_result - путь для сохранения результатов
   - all_tasks_file - имя файла со списком всех задач
   - done_tasks_file - имя файла со списком выполненных задач
   - flags_freq - массив частот, которые необходимо пропускать при синтезе (при отсутствии таковых список оставьте пустым: ```[]```)
   - number_of_clean_iter - количество итераций при чистке, для отключения чистки введите 0
   - frequencies - список частот для синтеза, для всех частот укажите ```list(range(16))```
   - scans - cписок сканов для синтеза, для всех сканов укажите ```list(range(20))```
   - num_threads - число потоков для расчетов, определяется исходя из возможностей вашего ПК
2. Запустить ```run.py```